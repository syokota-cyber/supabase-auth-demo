# Supabase Auth Demo

## 🎯 プロジェクト概要
SupabaseとVercelを使った認証機能のデモアプリケーション

**公開URL**: https://supabase-auth-demo-three.vercel.app/

## 📅 学習記録

### 2025年7月22日 - 基本認証機能実装

### 学習した内容
1. **Supabaseの基本**
   - BaaS（Backend as a Service）の概念
   - 認証機能の実装
   - APIキーの使い方

2. **Vercelの基本**
   - ホスティングサービスの仕組み
   - GitHubとの連携
   - 自動デプロイ

3. **実装した機能**
   - ユーザー登録（サインアップ）
   - ログイン/ログアウト
   - メール確認フロー
   - セッション管理

### 遭遇した問題と解決方法

#### 1. メール確認リンクの問題
- **問題**: メール確認リンクが`localhost:3000`を指していてアクセスできない
- **原因**: `file://`でHTMLを直接開いていたため
- **解決**: 
  - 開発時は`npm run dev`でローカルサーバーを使用
  - 本番環境（Vercel）では自動的に正しいURLになる

#### 2. APIキーエラー
- **問題**: "No API key found in request"エラー
- **原因**: 外部JavaScriptファイルが正しく読み込まれていない
- **解決**: JavaScriptをHTML内に直接記述

#### 3. Email not confirmedエラー
- **問題**: メール確認済みなのにログインできない
- **原因**: Supabaseのメール確認の仕組みとローカル開発環境の相性
- **解決**: 時間経過で自動解決／ダッシュボードで手動確認

### 2025年7月23日 - TODOリスト機能・UI改善・プロフィール機能実装

### 学習した内容（7月23日）
1. **Tailwind CSS基礎**
   - CDN版とNPM版の違い
   - ユーティリティファーストCSSの概念
   - Bootstrapとの比較（コンポーネントベース vs ユーティリティファースト）

2. **Supabaseデータベース機能**
   - PostgreSQL完全版の活用
   - todosテーブルの作成（GUI操作）
   - CRUD操作の実装
   - user_idによるデータ分離の重要性

3. **JavaScript実行環境の理解**
   - ブラウザのJavaScriptエンジン（V8等）の役割
   - Web APIとの連携
   - JavaScript → HTTPS → Supabaseサーバー → PostgreSQLの流れ

4. **UI/UXデザイン実装**
   - レスポンシブデザイン（Flexbox活用）
   - カード型デザインパターン
   - ユーザーフィードバック（ホバー効果、フォーカス状態）

### 実装した機能（7月23日）
- ✅ **TODOリスト機能**
  - TODO追加・表示・完了切り替え
  - ユーザー別データ分離
  - リアルタイムUI更新

- ✅ **デザイン大幅改善**
  - Tailwind CSS導入
  - 全体レイアウト（中央寄せ、余白）
  - ボタンデザイン（色分け、ホバー効果）
  - 入力フィールド（フォーカス状態、リング効果）

- ✅ **ユーザープロフィール機能**
  - ユーザー情報表示（メール、登録日、最終ログイン）
  - ダッシュボード形式のレイアウト

### 重要な質問と理解（7月23日）
1. **Q: CDN版とは何か？**
   - A: Content Delivery Network経由でライブラリを読み込み、設定不要で即座に使用開始可能

2. **Q: BootstrapとTailwindの違いは？**
   - A: Bootstrap（コンポーネントベース）vs Tailwind（ユーティリティファースト、クラス組み合わせで自由デザイン）

3. **Q: なぜuser_idで紐付けるのか？**
   - A: セキュリティ（データ分離）、データ整合性、マルチユーザー対応のため

4. **Q: JavaScriptを背後で動かしているのは？**
   - A: ブラウザのJavaScriptエンジン（V8等）とWeb API

5. **Q: Vercelの反映タイミングは？**
   - A: Git → GitHub → Vercel自動デプロイ（約1-2分）

6. **Q: Supabaseのデータベースは認証以外も使える？**
   - A: PostgreSQL完全版で、テーブル作成・リレーション・SQL全機能利用可能

### 学習効果の高いポイント
- **段階的実装**: 5行以下のコード変更で理解確認
- **選択肢の提示**: 3つの選択肢とメリット・デメリット比較
- **理由の説明**: なぜその実装方法を選んだかの明確化
- **実践重視**: 理論だけでなく実際のコード実装

### 技術スタック（最新）
- **フロントエンド**: HTML + JavaScript（Vanilla） + Tailwind CSS
- **バックエンド**: Supabase（認証 + PostgreSQL）
- **ホスティング**: Vercel（Git連携自動デプロイ）
- **バージョン管理**: Git/GitHub

### ファイル構成
```
supabase-auth-demo/
├── index.html          # メインの認証画面
├── auth.js            # 認証ロジック（未使用）
├── package.json       # プロジェクト設定
├── .gitignore         # Git除外設定
└── README.md          # このファイル
```

### 開発コマンド
```bash
# ローカルサーバー起動
npm run dev

# Gitにプッシュ（Vercelが自動デプロイ）
git add .
git commit -m "変更内容"
git push
```

### 今後の学習予定
- [x] データベース機能の追加（TODOリスト）✅ 完了
- [x] デザインの改善（Tailwind CSS）✅ 完了
- [ ] ソーシャルログイン（Google/GitHub）
- [ ] Next.jsへの移行
- [ ] TODO削除機能
- [ ] TODO編集機能
- [ ] カテゴリ分け機能

### 重要な学習ポイント
1. **開発環境の重要性**: `file://`ではなく適切なローカルサーバーを使用
2. **デバッグスキル**: コンソールログとエラーメッセージの読み方
3. **本番環境との違い**: ローカルと本番環境での動作の違いを理解
4. **段階的な実装**: 小さく始めて徐々に機能を追加

---

## 次回の作業メモ
- TODO削除・編集機能の追加
- ソーシャルログイン機能の実装
- より高度なUI/UXの実装（アニメーション等）
- Next.jsへの移行検討

---

## 📈 学習の成果
- **認証システム**: 完全動作するユーザー管理
- **データベース操作**: CRUD操作の理解
- **モダンCSS**: Tailwindによる効率的デザイン実装  
- **フルスタック理解**: フロントエンド→API→データベースの全体像把握

---

## 🚀 TODOアプリ拡張計画（2025年7月24日〜）

### 📊 開発ロードマップ

#### Phase 1: 基本拡張（7/24-25）
- [ ] カテゴリ機能（仕事/プライベート/買い物）
- [ ] 優先度設定（高/中/低）  
- [ ] 期限設定機能
- [ ] リッチなダッシュボードUI

#### Phase 2: 中級機能（7/26-28）
- [ ] 検索・フィルタ機能
- [ ] タグシステム
- [ ] 統計ダッシュボード（グラフ表示）
- [ ] インタラクティブなアニメーション

#### Phase 3: メモ共有への橋渡し（7/29-31）
- [ ] メモ欄追加（Markdown対応）
- [ ] 共有機能の基礎
- [ ] 公開/非公開設定

### 🎨 UI/UXデザイン方針
- **ダッシュボード**: カード型レイアウト、統計グラフ、アニメーション効果
- **インタラクティブ性**: ホバー効果、スムーズな遷移、ドラッグ&ドロップ
- **レスポンシブ**: モバイル最適化
- **カラーテーマ**: ダークモード対応検討

### 🗄️ DB拡張設計
```sql
-- Phase 1で追加予定
ALTER TABLE todos ADD COLUMN category TEXT DEFAULT 'general';
ALTER TABLE todos ADD COLUMN priority INTEGER DEFAULT 2;
ALTER TABLE todos ADD COLUMN due_date TIMESTAMP;

-- Phase 2で追加予定
CREATE TABLE tags (
  id SERIAL PRIMARY KEY,
  name TEXT UNIQUE
);

CREATE TABLE todo_tags (
  todo_id INTEGER REFERENCES todos(id),
  tag_id INTEGER REFERENCES tags(id)
);

-- Phase 3で追加予定
ALTER TABLE todos ADD COLUMN notes TEXT;
ALTER TABLE todos ADD COLUMN is_public BOOLEAN DEFAULT false;
```

### 🔄 今後の発展計画
1. **初級**: TODOアプリ拡張 → メモ共有アプリ
2. **中級**: アンケートシステム → 家計簿アプリ
3. **上級**: チャットアプリ → SNS機能

### 📝 再開時のコマンド
```bash
# プロジェクトディレクトリへ移動
cd /Users/syokota_mac/Desktop/claude-code/learning-projects/supabase-auth-demo

# 現在の状態確認
git status

# ローカルサーバー起動（必要に応じて）
npm run dev

# 本番環境確認
open https://supabase-auth-demo-three.vercel.app/
```

### 2025年7月24日 - Phase1完了: カテゴリ・優先度・期限・統計ダッシュボード機能実装

### 学習した内容（7月24日）
1. **段階的実装の重要性**
   - 小さな単位での機能追加の効率性
   - 一度に5行以上のコード変更を避ける学習重視アプローチ
   - 理解確認を挟みながらの進行

2. **データベース設計とUI連携**
   - Supabaseテーブルへのカラム追加（category, priority, due_date）
   - フロントエンドとバックエンドの連携タイミング
   - スキーマ変更後のエラーハンドリング

3. **レスポンシブデザインの理解**
   - Tailwind CSSのグリッドシステム（grid-cols-2 md:grid-cols-4 → grid-cols-4）
   - PC基準とモバイル基準のアプローチの違い
   - max-w-md → max-w-4xlでの画面幅対応

4. **file://とlocalhost開発環境の違い**
   - file://プロトコル: 簡単だが制限あり、CORS制限、本番環境と異なる
   - localhost: 本番環境に近い、機能制限なし、サーバー起動必要
   - Supabase Site URL設定との関係性

### 実装した機能（7月24日）
- ✅ **カテゴリ機能**
  - 4種類（一般/仕事/プライベート/買い物）
  - 色分けバッジ表示
  - DB: categoryカラム（text, default: 'general'）

- ✅ **優先度機能**  
  - 3段階（高/中/低）
  - 優先度順ソート機能
  - 色分け表示（赤=高、黄=中、緑=低）
  - DB: priorityカラム（int2, default: 2）

- ✅ **期限設定機能**
  - 日付入力（HTML5 date input）
  - 期限切れ自動判定と視覚的警告
  - カレンダーアイコン付き表示
  - DB: due_dateカラム（timestamptz, nullable）

- ✅ **統計ダッシュボード**
  - 4つのグラデーションカード（総数/完了/期限切れ/高優先度）
  - リアルタイム統計更新
  - ホバーアニメーション（transform hover:scale-105）
  - レスポンシブグリッドレイアウト

- ✅ **PC基準レスポンシブ対応**
  - 統計カードの横並び表示
  - 画面幅の拡張（max-w-4xl）

### 遭遇した問題と解決方法（7月24日）

#### 1. 認証エラーの誤った解決
- **問題**: ダミーメールでサインアップが400エラー
- **誤った対応**: 設定変更やコード修正を繰り返し
- **実際の原因**: 実在しないメールアドレスとEmail confirmation設定
- **学習**: 既に動作している機能（shin1yokota@gmail.com）があるのに、無意味なダミーテストを繰り返していた

#### 2. 計画からの逸脱
- **問題**: 認証機能の細かい調整に時間を費やし、本来のTODOアプリ拡張計画から逸脱
- **解決**: README.mdで計画を再確認し、軌道修正
- **学習**: 定期的な計画確認の重要性

#### 3. レイアウト崩れの誤解
- **問題**: モバイル表示（縦並び）を「崩れ」と誤認
- **原因**: レスポンシブデザインの理解不足
- **解決**: PC基準のレイアウトに変更
- **学習**: レスポンシブデザインの意図と実装の違い

#### 4. データベーススキーマ同期エラー
- **問題**: `column todos.priority does not exist`エラー
- **原因**: コードは更新したがSupabaseテーブルのカラム追加が未実施
- **解決**: Supabaseダッシュボードで手動カラム追加
- **学習**: フロントエンド・バックエンド・データベースの同期の重要性

### 重要な気づき（7月24日）
1. **道草の危険性**: 既に動作している機能に対する不要な「改善」は時間の無駄
2. **計画の重要性**: README.mdの計画を定期的に確認し、軌道修正する
3. **開発環境の選択**: file://とlocalhostの違いを理解して適切に選択
4. **データベース優先**: スキーマ変更は必ずデータベース側から先に実施
5. **レスポンシブデザイン**: モバイルファーストとPC基準の違いと使い分け

### 学習効果の高かった点
- **最速実装**: 余計な道草を避けて、目標機能を最短で実装
- **問題解決力**: エラーの原因を特定し、適切な解決策を選択
- **計画管理**: 計画からの逸脱を認識し、軌道修正する能力

### 技術スタック（最新）
- **フロントエンド**: HTML + JavaScript（Vanilla） + Tailwind CSS
- **バックエンド**: Supabase（認証 + PostgreSQL）
- **ホスティング**: Vercel（Git連携自動デプロイ）
- **バージョン管理**: Git/GitHub
- **開発環境**: file://（Supabase Site URL設定済み）

### 今後の学習予定（Phase2: 7/25-28）
- [ ] 検索・フィルタ機能
- [ ] タグシステム  
- [ ] 統計ダッシュボード（グラフ表示）
- [ ] インタラクティブなアニメーション

---

### 2025年7月25日 - Phase2実装: リアルタイム検索・統計グラフ・ドラッグ&ドロップ機能

### 学習した内容（7月25日）
1. **HTML5 Drag and Drop API**
   - dragstart, dragover, drop, dragend イベントの役割
   - preventDefault()でデフォルト動作を無効化
   - dataset属性でのデータ受け渡し
   - 視覚的フィードバック（opacity変更）の重要性

2. **Chart.js による データ可視化**
   - CDN経由でのライブラリ導入
   - canvas要素とSVGの違い（ビットマップ vs ベクター）
   - ドーナツチャート（カテゴリ別）と棒グラフ（優先度別）
   - Chart.js vs D3.js vs Highchartsの比較

3. **リアルタイム検索とフィルタリング**
   - input イベントと change/keyup イベントの違い
   - 複合フィルタのロジック（AND条件）
   - filter().lengthでの集計処理
   - データベースアクセス削減のためのデータ保持

4. **配列操作とアルゴリズム**
   - findIndex()での要素位置取得
   - 分割代入による要素交換: [a[i], a[j]] = [a[j], a[i]]
   - parseInt()での文字列→数値変換

### 実装した機能（7月25日）
- ✅ **リアルタイム検索機能**
  - テキスト検索（部分一致、大文字小文字区別なし）
  - カテゴリフィルタ（一般/仕事/プライベート/買い物）
  - 優先度フィルタ（高/中/低）
  - 複合フィルタ対応（すべての条件をAND結合）

- ✅ **統計グラフ表示（Chart.js）**
  - カテゴリ別ドーナツチャート（色分け表示）
  - 優先度別棒グラフ（高さで比較）
  - リアルタイム更新（TODOの変更と連動）
  - グラフインスタンスの適切な破棄処理

- ✅ **ドラッグ&ドロップ並び替え**
  - HTML5 Drag and Drop API使用
  - 視覚的フィードバック（半透明化）
  - ボタン部分のドラッグ無効化
  - 配列内要素の位置交換による並び替え

### 重要な学習ポイント（7月25日）
1. **イベント処理の深い理解**
   - input vs change vs keyup の使い分け
   - preventDefault() の重要性と役割
   - イベントバブリングとclosest()メソッド

2. **データ構造とアルゴリズム**
   - 配列のフィルタリングと集計処理
   - 要素の位置交換アルゴリズム
   - メモリ効率を考慮したデータ保持

3. **外部ライブラリの活用**
   - CDN vs NPM の違いと使い分け
   - Chart.js の基本的な使い方
   - ライブラリ選択の判断基準

4. **ユーザビリティの考慮**
   - 直感的な操作感の実現
   - 視覚的フィードバックの重要性
   - グラフの種類選択（円グラフ vs 棒グラフ）

### 技術的な気づき（7月25日）
1. **canvas vs SVG**: アニメーション性能を重視する場合はcanvas
2. **イベントリスナーの最適化**: 必要最小限のイベントだけを監視
3. **データの持ち方**: フィルタリング時のパフォーマンス向上のためのデータ保持
4. **UI/UXデザイン**: 機能的価値と視覚的価値のバランス

### 遭遇した問題と解決方法（7月25日）
#### 1. ドラッグ&ドロップの動作不良
- **問題**: ボタンをクリックするとドラッグが誤動作
- **原因**: ボタンもドラッグ可能になっていた
- **解決**: ボタンに draggable="false" を設定

#### 2. グラフの重複描画
- **問題**: データ更新時にグラフが重なって表示
- **原因**: 既存のChart.jsインスタンスを破棄せずに新規作成
- **解決**: destroy()メソッドで既存インスタンスを削除

#### 3. フィルタ条件の理解
- **問題**: 複数フィルタの組み合わせロジックが不明確
- **解決**: AND条件での絞り込み（すべての条件を満たすもののみ表示）

### 本番環境デプロイ（7月25日）
- **方法**: Git → GitHub → Vercel 自動デプロイ
- **URL**: https://supabase-auth-demo-three.vercel.app/
- **デプロイ時間**: 約1-2分で反映

### 今後の学習予定（Phase3: 7/26-31）
- [ ] メモ機能追加（Markdown対応）
- [ ] 共有機能の基礎
- [ ] 公開/非公開設定
- [ ] タグシステム（多対多リレーション）
- [ ] より高度なアニメーション効果

---

### 🎯 次回の開始タスク（7/26）
1. メモ機能のUI設計と実装
2. Markdownエディタの検討
3. Phase3への準備作業